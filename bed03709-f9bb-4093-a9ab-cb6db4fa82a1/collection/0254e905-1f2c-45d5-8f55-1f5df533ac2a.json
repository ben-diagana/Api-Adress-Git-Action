{"info":{"_postman_id":"0254e905-1f2c-45d5-8f55-1f5df533ac2a","name":"Address API","description":"Ma Ville Mon Shopping User API","schema":"https://schema.getpostman.com/json/collection/v2.1.0/collection.json"},"item":[{"name":"api/v1/addresses","item":[{"name":"Search","event":[{"listen":"test","script":{"id":"58f96375-5d39-4f55-93c0-85f0faebdd7f","exec":["\r","var jsonData = pm.response.json();\r","pm.collectionVariables.set(\"variable_key\", \"variable_value\");\r","pm.test(\"Status code is 200\", function () {\r","    pm.response.to.have.status(200);\r","});\r","\r","pm.test('verification du contenu de la reponse', function () {\r","    pm.expect(jsonData[0].streetNumber).to.be.a('string');\r","    pm.expect(jsonData[0].route).to.be.a('string');\r","    pm.expect(jsonData[0].postalCode).to.be.a('string');\r","    pm.expect(jsonData[0].country).to.eql('France');\r","    pm.expect(jsonData[0]).to.have.property('latitude');\r","    pm.expect(jsonData[0]).to.have.property('longitude');\r","    pm.expect(jsonData[0].capAddressInformations.streetId).to.not.equal('null');\r","    pm.expect(jsonData[0].capAddressInformations.streetNumberId).to.not.equal('null');\r","    pm.expect(jsonData[0].capAddressInformations.localityId).to.be.a('string');\r","\r","})\r","\r","pm.test('envoi des variable à la route validate', function (){\r","\r","    pm.environment.set(\"localityId\", jsonData[0].capAddressInformations.localityId);\r","    pm.environment.set(\"streetId\", jsonData[0].capAddressInformations.streetId);\r","    pm.environment.set(\"streetNumberId\", jsonData[0].capAddressInformations.streetNumberId);\r","    pm.environment.set(\"streetNumber\", jsonData[0].streetNumber);\r","\r","\r","    postman.setNextRequest('Validate')\r","})"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"c2cdf2a0-58e9-4aab-869e-71e83bcf5ac2","exec":["let adress = \"26 Allée des troubadours 33830 Belin beliet\";\r","pm.environment.set('SearchAdress', adress)"],"type":"text/javascript"}}],"id":"761ee9dd-1ef0-4d93-9981-a414e7e6ccb8","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"apikey","apikey":[{"key":"value","value":"{{ApiKey}}","type":"string"},{"key":"key","value":"authorization","type":"string"},{"key":"in","value":"header","type":"string"}]},"method":"POST","header":[{"key":"Accept","value":"application/json"}],"url":{"raw":"{{BaseUrl}}/{{AdressSlug}}/api/v1/addresses/search?q={{SearchAdress}}","host":["{{BaseUrl}}"],"path":["{{AdressSlug}}","api","v1","addresses","search"],"query":[{"key":"q","value":"{{SearchAdress}}"},{"key":null,"value":"","type":"text","disabled":true}]},"description":"Search some addresses to autocompletion by a query"},"response":[{"id":"1aeb9d17-23f9-476d-9760-46eda4fd4876","name":"Successful","originalRequest":{"method":"POST","header":[{"description":"Added as a part of security scheme: apikey","key":"authorization","value":"<API Key>"}],"url":{"raw":"{{baseUrl}}/api/v1/addresses/search?q=magna","host":["{{baseUrl}}"],"path":["api","v1","addresses","search"],"query":[{"key":"q","value":"magna"}]}},"status":"OK","code":200,"_postman_previewlanguage":"json","header":[{"key":"Content-Type","value":"application/json"}],"cookie":[],"responseTime":null,"body":"[\n  {\n    \"streetNumber\": \"15\",\n    \"route\": \"Rue de la victoire\",\n    \"postalCode\": \"33400\",\n    \"locality\": \"Talence\",\n    \"country\": \"France\",\n    \"longitude\": -1.5560594,\n    \"latitude\": 47.2171027,\n    \"capAddressInformations\": {\n      \"streetId\": \"037442600000\",\n      \"streetNumberId\": \"411672227T\",\n      \"localityId\": \"41167\"\n    }\n  },\n  {\n    \"streetNumber\": \"15\",\n    \"route\": \"Rue de la victoire\",\n    \"postalCode\": \"33400\",\n    \"locality\": \"Talence\",\n    \"country\": \"France\",\n    \"longitude\": -1.5560594,\n    \"latitude\": 47.2171027,\n    \"capAddressInformations\": {\n      \"streetId\": \"037442600000\",\n      \"streetNumberId\": \"411672227T\",\n      \"localityId\": \"41167\"\n    }\n  }\n]"}]},{"name":"Validate","event":[{"listen":"test","script":{"id":"f83b4fa1-3c28-4a91-a745-9ac74a2a6b81","exec":["var jsonData = pm.response.json();\r","\r","pm.test(\"Status code is 200\", function () {\r","    pm.response.to.have.status(200);\r","});\r","\r","pm.test('verification de la lattiude et de la logitude', function () {\r","    pm.expect(jsonData).to.have.property('latitude');\r","    pm.expect(jsonData.latitude).to.be.a('number');\r","    pm.expect(jsonData).to.have.property('longitude');\r","    pm.expect(jsonData.longitude).to.be.a('number');\r","})\r","\r","pm.test('envoi des variables à la route Reverse geocoding', function (){\r","\r","    pm.environment.set(\"latitude\", jsonData.latitude);\r","    pm.environment.set(\"longitude\", jsonData.longitude);\r","    \r"," postman.setNextRequest('Reverse geocoding search')\r","});\r",""],"type":"text/javascript"}}],"id":"3a2f1d65-f33d-4f9d-8278-e07e70bedcb3","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"apikey","apikey":[{"key":"value","value":"{{ApiKey}}","type":"string"},{"key":"key","value":"authorization","type":"string"},{"key":"in","value":"header","type":"string"}]},"method":"POST","header":[{"key":"Content-Type","value":"application/json"},{"key":"Accept","value":"application/json"}],"body":{"mode":"raw","raw":"{\n  \"localityId\": \"{{localityId}}\",\n  \"streetId\": \"{{streetId}}\",\n  \"streetNumberId\": \"{{streetNumberId}}\",\n  \"streetNumber\": \"{{streetNumber}}\",\n  \"enableGeocoding\": true\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{BaseUrl}}/{{AdressSlug}}/api/v1/addresses/validate","host":["{{BaseUrl}}"],"path":["{{AdressSlug}}","api","v1","addresses","validate"]},"description":"Validate an address getted by search route"},"response":[{"id":"dba0c279-417d-4cae-89ad-fef92ad8b94e","name":"Successful (with geocoding)","originalRequest":{"method":"POST","header":[{"description":"Added as a part of security scheme: apikey","key":"authorization","value":"<API Key>"}],"body":{"mode":"raw","raw":"{\n  \"localityId\": \"41167\",\n  \"streetId\": \"037442600000\",\n  \"streetNumberId\": \"411672227T\",\n  \"streetNumber\": \"52\",\n  \"enableGeocoding\": true\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{baseUrl}}/api/v1/addresses/validate?q=magna","host":["{{baseUrl}}"],"path":["api","v1","addresses","validate"],"query":[{"key":"q","value":"magna"}]}},"status":"OK","code":200,"_postman_previewlanguage":"json","header":[{"key":"Content-Type","value":"application/json"}],"cookie":[],"responseTime":null,"body":"{\n  \"streetNumber\": \"15\",\n  \"route\": \"Rue de la victoire\",\n  \"postalCode\": \"33400\",\n  \"locality\": \"Talence\",\n  \"country\": \"France\",\n  \"longitude\": -1.5560594,\n  \"latitude\": 47.2171027,\n  \"capAddressInformations\": {\n    \"streetId\": \"037442600000\",\n    \"streetNumberId\": \"411672227T\",\n    \"localityId\": \"41167\"\n  }\n}"},{"id":"34110b79-7bd4-4ea3-837c-f4c3e0e04028","name":"Successful","originalRequest":{"method":"POST","header":[{"description":"Added as a part of security scheme: apikey","key":"authorization","value":"<API Key>"}],"body":{"mode":"raw","raw":"{\n  \"localityId\": \"41167\",\n  \"streetId\": \"037442600000\",\n  \"streetNumberId\": \"411672227T\",\n  \"streetNumber\": \"52\",\n  \"enableGeocoding\": true\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{baseUrl}}/api/v1/addresses/validate?q=magna","host":["{{baseUrl}}"],"path":["api","v1","addresses","validate"],"query":[{"key":"q","value":"magna"}]}},"status":"No Content","code":204,"_postman_previewlanguage":"text","header":[{"key":"Content-Type","value":"text/plain"}],"cookie":[],"responseTime":null,"body":""},{"id":"0ab62d0c-97cb-4c7c-8f8d-dcccafb89c1c","name":"Bad Request","originalRequest":{"method":"POST","header":[{"description":"Added as a part of security scheme: apikey","key":"authorization","value":"<API Key>"}],"body":{"mode":"raw","raw":"{\n  \"localityId\": \"41167\",\n  \"streetId\": \"037442600000\",\n  \"streetNumberId\": \"411672227T\",\n  \"streetNumber\": \"52\",\n  \"enableGeocoding\": true\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{baseUrl}}/api/v1/addresses/validate?q=magna","host":["{{baseUrl}}"],"path":["api","v1","addresses","validate"],"query":[{"key":"q","value":"magna"}]}},"status":"Bad Request","code":400,"_postman_previewlanguage":"json","header":[{"key":"Content-Type","value":"application/json"}],"cookie":[],"responseTime":null,"body":"{\n  \"detail\": \"The syntax of the query is incorrect.\",\n  \"message\": \"Bad Request\",\n  \"status\": 400\n}"}]},{"name":"Reverse geocoding search","event":[{"listen":"test","script":{"id":"be7cb06c-cc9c-407e-8721-e8de7902f4d9","exec":["var jsonData = pm.response.json();\r","\r","pm.test(\"Status code is 200\", function () {\r","    pm.response.to.have.status(200);\r","});\r","\r","pm.test('verification du contenu de la reponse', function () {\r","    pm.expect(jsonData.streetNumber).to.be.a('string');\r","    pm.expect(jsonData.route).to.be.a('string');\r","    pm.expect(jsonData.postalCode).to.be.a('string');\r","    pm.expect(jsonData.country).to.eql('France');\r","    pm.expect(jsonData).to.have.property('latitude');\r","    pm.expect(jsonData.latitude).to.be.a('number');\r","    pm.expect(jsonData).to.have.property('longitude');\r","    \r","\r","})"],"type":"text/javascript"}}],"id":"b3209ceb-cb97-4347-a24d-dc591ca1e539","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"apikey","apikey":[{"key":"value","value":"{{ApiKey}}","type":"string"},{"key":"key","value":"authorization","type":"string"},{"key":"in","value":"header","type":"string"}]},"method":"POST","header":[{"key":"Content-Type","value":"application/json"},{"key":"Accept","value":"application/json"}],"body":{"mode":"raw","raw":"{\n  \"latitude\": {{latitude}},\n  \"longitude\": {{longitude}}\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{BaseUrl}}/{{AdressSlug}}/api/v1/addresses/reverse","host":["{{BaseUrl}}"],"path":["{{AdressSlug}}","api","v1","addresses","reverse"]},"description":"Search an address from latitude and longitude."},"response":[{"id":"dcd77b82-35eb-42b4-a913-a0cdd783d40f","name":"Successful","originalRequest":{"method":"POST","header":[{"description":"Added as a part of security scheme: apikey","key":"authorization","value":"<API Key>"}],"body":{"mode":"raw","raw":"{\n  \"latitude\": 4.12376,\n  \"longitude\": -0.12328\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{baseUrl}}/api/v1/addresses/reverse","host":["{{baseUrl}}"],"path":["api","v1","addresses","reverse"]}},"status":"OK","code":200,"_postman_previewlanguage":"json","header":[{"key":"Content-Type","value":"application/json"}],"cookie":[],"responseTime":null,"body":"[\n  {\n    \"streetNumber\": \"15\",\n    \"route\": \"Rue de la victoire\",\n    \"postalCode\": \"33400\",\n    \"locality\": \"Talence\",\n    \"country\": \"France\",\n    \"longitude\": -1.5560594,\n    \"latitude\": 47.2171027,\n    \"capAddressInformations\": {\n      \"streetId\": \"037442600000\",\n      \"streetNumberId\": \"411672227T\",\n      \"localityId\": \"41167\"\n    }\n  },\n  {\n    \"streetNumber\": \"15\",\n    \"route\": \"Rue de la victoire\",\n    \"postalCode\": \"33400\",\n    \"locality\": \"Talence\",\n    \"country\": \"France\",\n    \"longitude\": -1.5560594,\n    \"latitude\": 47.2171027,\n    \"capAddressInformations\": {\n      \"streetId\": \"037442600000\",\n      \"streetNumberId\": \"411672227T\",\n      \"localityId\": \"41167\"\n    }\n  }\n]"}]}],"id":"0b297e49-a526-43e5-98ca-f30a1880648c"}],"variable":[{"id":"10879f46-6598-418c-90a8-b9b1560b52db","key":"baseUrl","value":"https://stingy-advice-gw.aws-euc1.cloud-ara.tyk.io/address-management-dev","type":"string"},{"id":"ad559233-2799-45b9-8dc3-a8cfeec25755","key":"variable_key","value":""},{"id":"68e89933-5233-44cc-b249-4c3779320ff7","key":"locality","value":""},{"id":"3a56d0e2-d59d-49ea-8907-25f717e79ee5","key":"streetId","value":""},{"id":"1625320b-6c71-4b65-8768-4931adae4b3c","key":"streetNumberId","value":""},{"id":"dc52a6fb-880a-44b2-bf5d-6d01a89b0009","key":"streetNumber","value":""}]}